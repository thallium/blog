<!doctype html><html lang=en><head><meta charset=utf-8><title>CodeForces 1324F - Maximum White Subtree</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://tgc-thallium.com/blog/index.xml title="Thallium's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="CodeForces 1324F - Maximum White Subtree"><meta name=twitter:description content="好题！
Solution The solution consists of two DFS, first DFS is to calculate $sub_i$: the max difference of the subgraph in subtree of $i$. Note that we treat the graph as a rooted tree, so the subtree means the part that is lower than node $i$. This is pretty naive DFS.
The second dfs is to find the answer of each vertex. Since we only considered the contribution of the subtree, we need to add the contribution of other part the graph."><link rel=stylesheet href=https://tgc-thallium.com/blog/fontawesome/css/all.min.css><link rel=stylesheet href=https://tgc-thallium.com/blog/css/main.css><link id=dark-mode-theme rel=stylesheet href=https://tgc-thallium.com/blog/css/dark.css><script>var darkTheme=document.getElementById('dark-mode-theme'),storedTheme=localStorage.getItem('dark-mode-storage');storedTheme==='dark'?darkTheme.disabled=!1:storedTheme==='light'&&(darkTheme.disabled=!0)</script><script src=https://tgc-thallium.com/blog/js/main.bundle.js></script><script src=https://tgc-thallium.com/blog/js/instantpage.min.js type=module defer></script><meta name=generator content="Hugo 0.83.1"></head><body><header><nav class=navbar><div class=nav><ul class=nav-links><li><a href=/blog/ id=Home><em class="fas fa-home fa-lg"></em></a></li><li><a href=/blog/about/ id=About><em class="fas fa-user fa-lg"></em></a></li><li><a href=/blog/tags/ id=Tags><em class="fas fa-tag fa-lg"></em></a></li><li><a href=/blog/categories/ id=Categories><em class="fas fa-list fa-lg"></em></a></li><li><a href=/blog/archives/ id=Archives><em class="fas fa-archive fa-lg"></em></a></li><li><a href=/blog/search/ id=Search><em class="fas fa-search fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=post-heading><h1>CodeForces 1324F - Maximum White Subtree</h1><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;Jan 1, 0001</span></div></div></div></header><div class=container role=main><article class=article class=blog-post><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.css integrity=sha384-L+Gq2Cso/Y2x8fX4wausgiZT8z0QPZz7OqPuz4YqAycQJyrJT9NRLpjFBD6zlOia crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.js integrity=sha384-z64WtjpyrKFsxox9eI4SI8eM9toXdoYeWb5Qh+8PO+eG54Bv9BZqf9xNhlcLf/sA crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script><p>好题！</p><h1 id=solution>Solution</h1><p>The solution consists of two DFS, first DFS is to calculate $sub_i$: the max difference of the subgraph in subtree of $i$. Note that we treat the graph as a rooted tree, so the subtree means the part that is lower than node $i$. This is pretty naive DFS.</p><p>The second dfs is to find the answer of each vertex. Since we only considered the contribution of the subtree, we need to add the contribution of other part the graph. How to find this contribution? We always get the answer of higher nodes first. Let $v$ be the children of node $i$, if $sub_v>0$, the contribution is $ans_i-sub_v$ since we don&rsquo;t want to count the contribution of subtree twice. If $sub_v\leq 0$, we don&rsquo;t need to subtract $sub_v$ since we didn&rsquo;t count it in $ans_i$. If $ans_i-sub_v&lt;0$, it&rsquo;s useless for $ans_v$. Thus, the contribution of other part is $\max(ans_i-\max(sub_v,0),0)$.</p><h1 id=题解>题解</h1><p>答案分两步dfs，第一个dfs用来计算$sub_i$： $i$的子树中的的子图的最大差值。稍微有点绕，其实题目中的“子树”应该叫子图比较合适，因为是无根树，说子图没什么意义。但我们dfs的时候其实是把图当成有根树，所以第一次dfs得到的答案只考虑了子树的贡献，剩余部分的贡献由第二个dfs算。其他部分的贡献看英文吧……懒得再写一遍了（逃）。</p><h1 id=code>Code</h1><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#75715e>#define forn(i, n) for (int i = 0; i &lt; int(n); ++i)
</span><span style=color:#75715e>#define for1(i, n) for (int i = 1; i &lt;= int(n); ++i)
</span><span style=color:#75715e></span>
<span style=color:#00a8c8>using</span> <span style=color:#00a8c8>namespace</span> <span style=color:#111>std</span><span style=color:#111>;</span>
<span style=color:#00a8c8>typedef</span> <span style=color:#00a8c8>long</span> <span style=color:#00a8c8>long</span> <span style=color:#111>ll</span><span style=color:#111>;</span>

<span style=color:#00a8c8>const</span> <span style=color:#00a8c8>int</span> <span style=color:#111>N</span><span style=color:#f92672>=</span><span style=color:#ae81ff>2e5</span><span style=color:#f92672>+</span><span style=color:#ae81ff>5</span><span style=color:#111>;</span>
<span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>G</span><span style=color:#111>[</span><span style=color:#111>N</span><span style=color:#111>];</span>
<span style=color:#00a8c8>int</span> <span style=color:#111>ans</span><span style=color:#111>[</span><span style=color:#111>N</span><span style=color:#111>],</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#111>N</span><span style=color:#111>],</span><span style=color:#111>dp</span><span style=color:#111>[</span><span style=color:#111>N</span><span style=color:#111>];</span>
<span style=color:#00a8c8>void</span> <span style=color:#75af00>dfs1</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>u</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>fa</span><span style=color:#111>){</span>
	<span style=color:#111>dp</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>];</span>
	<span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>auto</span> <span style=color:#111>it</span><span style=color:#111>:</span><span style=color:#111>G</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]){</span>
		<span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>it</span><span style=color:#f92672>!=</span><span style=color:#111>fa</span><span style=color:#111>){</span>
			<span style=color:#111>dfs1</span><span style=color:#111>(</span><span style=color:#111>it</span><span style=color:#111>,</span><span style=color:#111>u</span><span style=color:#111>);</span>
			<span style=color:#111>dp</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span><span style=color:#f92672>+=</span><span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#111>dp</span><span style=color:#111>[</span><span style=color:#111>it</span><span style=color:#111>]);</span>
		<span style=color:#111>}</span>
	<span style=color:#111>}</span>
<span style=color:#111>}</span>
<span style=color:#00a8c8>void</span> <span style=color:#75af00>dfs2</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>u</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>fa</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>pd</span><span style=color:#111>){</span>
	<span style=color:#111>ans</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#111>dp</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span><span style=color:#f92672>+</span><span style=color:#111>pd</span><span style=color:#111>;</span>
	<span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>auto</span> <span style=color:#111>v</span><span style=color:#111>:</span><span style=color:#111>G</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]){</span>
		<span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>v</span><span style=color:#f92672>!=</span><span style=color:#111>fa</span><span style=color:#111>){</span>
			<span style=color:#111>dfs2</span><span style=color:#111>(</span><span style=color:#111>v</span><span style=color:#111>,</span><span style=color:#111>u</span><span style=color:#111>,</span><span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#111>ans</span><span style=color:#111>[</span><span style=color:#111>u</span><span style=color:#111>]</span><span style=color:#f92672>-</span><span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#111>dp</span><span style=color:#111>[</span><span style=color:#111>v</span><span style=color:#111>],</span><span style=color:#ae81ff>0</span><span style=color:#111>),</span><span style=color:#ae81ff>0</span><span style=color:#111>));</span>
		<span style=color:#111>}</span>
	<span style=color:#111>}</span>
<span style=color:#111>}</span>
<span style=color:#00a8c8>int</span> <span style=color:#75af00>main</span><span style=color:#111>()</span> <span style=color:#111>{</span>
	<span style=color:#111>ios</span><span style=color:#f92672>::</span><span style=color:#111>sync_with_stdio</span><span style=color:#111>(</span><span style=color:#111>false</span><span style=color:#111>);</span>
	<span style=color:#111>cin</span><span style=color:#111>.</span><span style=color:#111>tie</span><span style=color:#111>(</span><span style=color:#00a8c8>nullptr</span><span style=color:#111>);</span>
	<span style=color:#00a8c8>int</span> <span style=color:#111>n</span><span style=color:#111>;</span>
	<span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>n</span><span style=color:#111>;</span>
	<span style=color:#111>for1</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span><span style=color:#111>n</span><span style=color:#111>)</span> <span style=color:#111>{</span>
		<span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>];</span>
		<span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#f92672>!</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>])</span> <span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#f92672>=-</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
	<span style=color:#111>}</span>
	<span style=color:#111>forn</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span><span style=color:#111>n</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>){</span>
		<span style=color:#00a8c8>int</span> <span style=color:#111>x</span><span style=color:#111>,</span><span style=color:#111>y</span><span style=color:#111>;</span>
		<span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>x</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>y</span><span style=color:#111>;</span>
		<span style=color:#111>G</span><span style=color:#111>[</span><span style=color:#111>x</span><span style=color:#111>].</span><span style=color:#111>pb</span><span style=color:#111>(</span><span style=color:#111>y</span><span style=color:#111>);</span>
		<span style=color:#111>G</span><span style=color:#111>[</span><span style=color:#111>y</span><span style=color:#111>].</span><span style=color:#111>pb</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#111>);</span>
	<span style=color:#111>}</span>
	<span style=color:#111>dfs1</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>);</span>
	<span style=color:#111>dfs2</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>);</span>
	<span style=color:#111>for1</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span><span style=color:#111>n</span><span style=color:#111>)</span> <span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#111>ans</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#d88200>&#39; &#39;</span><span style=color:#111>;</span>
	<span style=color:#00a8c8>return</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
<span style=color:#111>}</span>
</code></pre></div><div class=blog-tags><a href=https://tgc-thallium.com/blog/tags/dfs/>DFS</a>&nbsp;
<a href=https://tgc-thallium.com/blog/tags/%E5%8A%A8%E6%80%81%E8%A7%84%E5%88%92/dp/>动态规划/DP</a>&nbsp;
<a href=https://tgc-thallium.com/blog/tags/%E6%A0%91/trees/>树/Trees</a>&nbsp;</div></article></div><footer><div class=social-icons><a href=https://github.com/thallium name=GitHub><em class="fab fa-github"></em></a></div><div class=container><p class="credits copyright"><a href=https://tgc-thallium.com/blog/about>hugo author</a>
&nbsp;&copy;
0001
&nbsp;/&nbsp;
<a href=https://tgc-thallium.com/blog/>Thallium's Blog</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>