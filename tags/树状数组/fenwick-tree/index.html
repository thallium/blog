<!doctype html><html lang=en><head><meta charset=utf-8><title>树状数组/Fenwick Tree</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://tgc-thallium.com/blog/index.xml title="Thallium's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="树状数组/Fenwick Tree"><meta name=twitter:description content><link rel=stylesheet href=https://tgc-thallium.com/blog/fontawesome/css/all.min.css><link rel=stylesheet href=https://tgc-thallium.com/blog/css/main.css><link id=dark-mode-theme rel=stylesheet href=https://tgc-thallium.com/blog/css/dark.css><script>var darkTheme=document.getElementById('dark-mode-theme'),storedTheme=localStorage.getItem('dark-mode-storage');storedTheme==='dark'?darkTheme.disabled=!1:storedTheme==='light'&&(darkTheme.disabled=!0)</script><script src=https://tgc-thallium.com/blog/js/main.bundle.js></script><script src=https://tgc-thallium.com/blog/js/instantpage.min.js type=module defer></script><meta name=generator content="Hugo 0.83.1"></head><body><header><nav class=navbar><div class=nav><ul class=nav-links><li><a href=/blog/ id=Home><em class="fas fa-home fa-lg"></em></a></li><li><a href=/blog/about/ id=About><em class="fas fa-user fa-lg"></em></a></li><li><a href=/blog/tags/ id=Tags><em class="fas fa-tag fa-lg"></em></a></li><li><a href=/blog/categories/ id=Categories><em class="fas fa-list fa-lg"></em></a></li><li><a href=/blog/archives/ id=Archives><em class="fas fa-archive fa-lg"></em></a></li><li><a href=/blog/search/ id=Search><em class="fas fa-search fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=tags-heading><h1>树状数组/Fenwick Tree</h1></div></div></div></header><div class=container role=main><div class=posts-list><article class=post-preview><a href=https://tgc-thallium.com/blog/1/01/01/2020-04-10-cd1208d/><h2 class=post-title>Editorial for Codeforces 1208D- Restore Permutation</h2></a><div class=post-entry><p>题目本身就很好，同时又能带来对树状数组的一些思考。
Solution We will solve the problem in reversed order. For every $i$ from $N$ to $1$, there exists some $k$ such that the sum of $k$ smallest unused numbers is $s_i$. The answer for the position $i$ is $k+1$. We can find $k$ by fenwick tree(BIT) and binary in $O(n\cdot \log(n)^2)$or fenwick tree with binary lifting in $O(n\cdot \log(n))$ time.
题解 我们要倒着处理，对于当前的$i$，会存在一个$k$，使得$k$个还没有用过的最小的数的和为$s_i$。那么当前$i$的答案就是$k+1$。可以用树状数组配二分找，也可以用树状数组配倍增黑科技求。
Code Binary search #include &lt;bits/stdc++.h> #define forn(i, n) for (int i = 0; i &lt; int(n); ++i) #define for1(i, n) for (int i = 1; i &lt;= int(n); ++i) #define fore(i, l, r) for (int i = int(l); i &lt;= int(r); ++i) #define ford(i, n) for (int i = int(n)-1; i >= 0; --i) #define pb push_back #define eb emplace_back #define ms(a, x) memset(a, x, sizeof(a)) #define F first #define S second #define endl '\n' #define all(x) (x).</p><a href=https://tgc-thallium.com/blog/1/01/01/2020-04-10-cd1208d/ class=post-read-more>Read More</a></div><div class=postmeta><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;Jan 1, 0001</span></div></article><article class=post-preview><a href=https://tgc-thallium.com/blog/1/01/01/2019-9-26-cf220b/><h2 class=post-title>Little Elephant and Array - CodeForces220B 树状数组</h2></a><div class=post-entry><p>据说莫队更简单，然而不会啊
题目链接
考虑维护一个数组$D$，使得$D_l,D_{l+1},\dots,D_{r-1},D_r$的和为询问$[l,r]$的答案。用线段树或树状数组都行（显然树状数组比较好写）。从左边开始遍历数组，当下标为$i$时，我们应该处理完所有$r=i$的询问。
下面我们用一个最简单的例子来说明这个思路（下标从1开始）:
$$A:3,3,3,3,3 \D:0,0,0,0,0$$
当$i=3$时，3这个数第一次出现3次，所以我们应让$D_1+1$，这样只有[1,3]这个询问才会得到1。
当$i=4$时，按照刚才的想法，我们应让$D_2+1$:
$$A:3,3,3,3,3 \D:1,1,0,0,0$$
但这时如果我们有$[1,4]$的询问，那么就会得到2，但答案应该为0，所以我们这时应将$D_1-2$：
$$A: \quad 3,3,3,3,3 \D:-1,1,0,0,0$$
这样就能正确处理$[1,4]$的询问了。
现在$i=5$了，如果延续刚才的思路，现在应该是这样的:
$$A: \quad 3,\enspace 3,3,3,3 \D:-1,-1,1,0,0$$
这样一来，$[1,5]$的询问又不对了，所以我们应该让$D_1+1$来抵消第二步。这就是这个题的基本思路。
代码
#include &lt;bits/stdc++.h> #define forn(i, n) for (int i = 0; i &lt; (int)(n); ++i) #define for1(i, n) for (int i = 1; i &lt;= (int)(n); ++i) #define fore(i, l, r) for (int i = (int)(l); i &lt;= (int)(r); ++i) #define ford(i, n) for (int i = (int)(n)-1; i >= 0; --i) #define endl '\n' using namespace std; const int INF = 0x3f3f3f3f; typedef long long ll; typedef pair&lt;int, int> pii; int n, m, sqn; const int N = 1e5 + 5; struct node { int l, r, i; bool operator&lt;(node a) { return r &lt; a.</p><a href=https://tgc-thallium.com/blog/1/01/01/2019-9-26-cf220b/ class=post-read-more>Read More</a></div><div class=postmeta><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;Jan 1, 0001</span></div></article><article class=post-preview><a href=https://tgc-thallium.com/blog/1/01/01/2020-05-21-cf1268c/><h2 class=post-title>Tutorial for Codeforces 1268C/1269E</h2></a><div class=post-entry><p>又一道pbds
Solution Forming a subsegment of $1,2,3,\dots,k$ consists two steps:
Make numbers $1,2,3,\dots,k$ form a subsegment in any order.
Change the order of numbers to form $1,2,3,\dots,k$.
The first step reminds us a classic problem: moving some points to one points with the minimum moves. The optimal way is to move all the points to the points in the middle. Let the coordinate of the points be $p_i$ and the point in the middle be $mid$, the answer is $\sum\vert mid-pos_i\vert $.</p><a href=https://tgc-thallium.com/blog/1/01/01/2020-05-21-cf1268c/ class=post-read-more>Read More</a></div><div class=postmeta><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;Jan 1, 0001</span></div></article></div><ul class=pager><li class=next><a href=https://tgc-thallium.com/blog/tags/%E6%A0%91%E7%8A%B6%E6%95%B0%E7%BB%84/fenwick-tree/page/2/>Older &rarr;</a></li></ul></div><footer><div class=social-icons><a href=https://github.com/thallium name=GitHub><em class="fab fa-github"></em></a></div><div class=container><p class="credits copyright"><a href=https://tgc-thallium.com/blog/about>hugo author</a>
&nbsp;&copy;
0001
&nbsp;/&nbsp;
<a href=https://tgc-thallium.com/blog/>Thallium's Blog</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>