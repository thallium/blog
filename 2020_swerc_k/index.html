<!doctype html><html lang=en><head><meta charset=utf-8><title>Solution for 2020 ICPC SWERC K - Unique Activities</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://blog.tgc-thallium.com/index.xml title="Thallium's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Solution for 2020 ICPC SWERC K - Unique Activities"><meta name=twitter:description content><link rel=stylesheet href=https://blog.tgc-thallium.com/fontawesome/css/all.min.css><link rel=stylesheet href=https://blog.tgc-thallium.com/css/main.css><link id=dark-mode-theme rel=stylesheet href=https://blog.tgc-thallium.com/css/dark.css><script>var darkTheme=document.getElementById('dark-mode-theme'),storedTheme=localStorage.getItem('dark-mode-storage');storedTheme==='dark'?darkTheme.disabled=!1:storedTheme==='light'&&(darkTheme.disabled=!0)</script><script src=https://blog.tgc-thallium.com/js/main.bundle.js></script><script src=https://blog.tgc-thallium.com/js/instantpage.min.js type=module defer></script><meta name=generator content="Hugo 0.83.1"></head><body><header><nav class=navbar><div class=nav><p class=lang><i class="fas fa-globe"></i>
<a href=https://blog.tgc-thallium.com/zh-hans/ title="no translation">中文</a></p><ul class=nav-links><li><a href=/ id=Home title=Home><em class="fas fa-home fa-lg"></em></a></li><li><a href=/about/ id=About title=About><em class="fas fa-user fa-lg"></em></a></li><li><a href=/tags/ id=Tags title=Tags><em class="fas fa-tag fa-lg"></em></a></li><li><a href=/categories/ id=Categories title=Categories><em class="fas fa-list fa-lg"></em></a></li><li><a href=/archives/ id=Archives title=Archives><em class="fas fa-archive fa-lg"></em></a></li><li><a href=/search/ id=Search title=Search><em class="fas fa-search fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=post-heading><h1>Solution for 2020 ICPC SWERC K - Unique Activities</h1><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;May 18, 2021
&nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
<a href=https://blog.tgc-thallium.com/categories/solutions/>Solutions</a>&nbsp;</span></div></div></div></header><div class=container role=main><article class=article class=blog-post><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.css integrity=sha384-L+Gq2Cso/Y2x8fX4wausgiZT8z0QPZz7OqPuz4YqAycQJyrJT9NRLpjFBD6zlOia crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.js integrity=sha384-z64WtjpyrKFsxox9eI4SI8eM9toXdoYeWb5Qh+8PO+eG54Bv9BZqf9xNhlcLf/sA crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script><aside><nav id=TableOfContents><ul><li><a href=#solution-1-suffix-array>Solution 1: Suffix Array</a></li><li><a href=#solution-2-binary-search--string-hashing>Solution 2: Binary Search + String Hashing</a></li></ul></nav></aside><h2 id=solution-1-suffix-array>Solution 1: Suffix Array</h2><p>For each suffix starting from $i$, the length of the shortest unique substring which is a prefix of that suffix is $\max(lcp_i, lcp_{i+1})+1$ where $lcp_0$ and $lcp_{n}$ is defined to be $0$. Note that if that length is greater than the length of suffix, it&rsquo;s an invalid substring</p><p>Code:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span><span style=color:#75715e></span><span style=color:#00a8c8>using</span> <span style=color:#00a8c8>namespace</span> <span style=color:#111>std</span><span style=color:#111>;</span>
<span style=color:#00a8c8>using</span> <span style=color:#111>ll</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>long</span> <span style=color:#00a8c8>long</span><span style=color:#111>;</span>
<span style=color:#00a8c8>using</span> <span style=color:#111>pii</span> <span style=color:#f92672>=</span> <span style=color:#111>pair</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span><span style=color:#111>;</span>

<span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>suffix_array</span><span style=color:#111>(</span><span style=color:#111>string</span> <span style=color:#111>s</span><span style=color:#111>)</span> <span style=color:#111>{</span>
    <span style=color:#111>s</span><span style=color:#f92672>+=</span><span style=color:#d88200>&#34;#&#34;</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>n</span> <span style=color:#f92672>=</span> <span style=color:#111>s</span><span style=color:#111>.</span><span style=color:#111>size</span><span style=color:#111>(),</span> <span style=color:#111>N</span> <span style=color:#f92672>=</span> <span style=color:#111>n</span> <span style=color:#f92672>+</span> <span style=color:#ae81ff>256</span><span style=color:#111>;</span>
    <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>sa</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#111>),</span> <span style=color:#111>ra</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>ra</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>s</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>];</span>
    <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>k</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>k</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>k</span> <span style=color:#f92672>?</span> <span style=color:#111>k</span> <span style=color:#f92672>*=</span> <span style=color:#ae81ff>2</span> <span style=color:#f92672>:</span> <span style=color:#111>k</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
        <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>nsa</span><span style=color:#111>(</span><span style=color:#111>sa</span><span style=color:#111>),</span> <span style=color:#111>nra</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#111>),</span> <span style=color:#111>cnt</span><span style=color:#111>(</span><span style=color:#111>N</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>nsa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>=</span> <span style=color:#111>(</span><span style=color:#111>nsa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>-</span> <span style=color:#111>k</span> <span style=color:#f92672>+</span> <span style=color:#111>n</span><span style=color:#111>)</span> <span style=color:#f92672>%</span> <span style=color:#111>n</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>ra</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]]</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>N</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>+=</span> <span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>i</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>];</span>
        <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#111>n</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&gt;=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>--</span><span style=color:#111>)</span> <span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#f92672>--</span><span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>ra</span><span style=color:#111>[</span><span style=color:#111>nsa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]]]]</span> <span style=color:#f92672>=</span> <span style=color:#111>nsa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>];</span>
 
        <span style=color:#00a8c8>int</span> <span style=color:#111>r</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>1</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
            <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>ra</span><span style=color:#111>[</span><span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]]</span> <span style=color:#f92672>!=</span> <span style=color:#111>ra</span><span style=color:#111>[</span><span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>]])</span> <span style=color:#111>r</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
            <span style=color:#00a8c8>else</span> <span style=color:#75af00>if</span><span style=color:#111>(</span><span style=color:#111>ra</span><span style=color:#111>[(</span><span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span> <span style=color:#f92672>+</span> <span style=color:#111>k</span><span style=color:#111>)</span> <span style=color:#f92672>%</span> <span style=color:#111>n</span><span style=color:#111>]</span> <span style=color:#f92672>!=</span> <span style=color:#111>ra</span><span style=color:#111>[(</span><span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span> <span style=color:#f92672>-</span> <span style=color:#ae81ff>1</span><span style=color:#111>]</span> <span style=color:#f92672>+</span> <span style=color:#111>k</span><span style=color:#111>)</span> <span style=color:#f92672>%</span> <span style=color:#111>n</span><span style=color:#111>])</span> <span style=color:#111>r</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
            <span style=color:#111>nra</span><span style=color:#111>[</span><span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]]</span> <span style=color:#f92672>=</span> <span style=color:#111>r</span><span style=color:#111>;</span>
        <span style=color:#111>}</span>
        <span style=color:#111>ra</span> <span style=color:#f92672>=</span> <span style=color:#111>nra</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>
    <span style=color:#111>sa</span><span style=color:#111>.</span><span style=color:#111>erase</span><span style=color:#111>(</span><span style=color:#111>sa</span><span style=color:#111>.</span><span style=color:#111>begin</span><span style=color:#111>());</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>sa</span><span style=color:#111>;</span>
<span style=color:#111>}</span>

<span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>build_lcp</span><span style=color:#111>(</span><span style=color:#00a8c8>const</span> <span style=color:#111>string</span><span style=color:#f92672>&amp;</span> <span style=color:#111>s</span><span style=color:#111>,</span> <span style=color:#00a8c8>const</span> <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;&amp;</span> <span style=color:#111>sa</span><span style=color:#111>)</span> <span style=color:#111>{</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>n</span><span style=color:#f92672>=</span><span style=color:#111>s</span><span style=color:#111>.</span><span style=color:#111>size</span><span style=color:#111>();</span>
    <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>pos</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>pos</span><span style=color:#111>[</span><span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]]</span> <span style=color:#f92672>=</span> <span style=color:#111>i</span><span style=color:#111>;</span>

    <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>lcp</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>k</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span> <span style=color:#f92672>&lt;</span> <span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>pos</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#f92672>==</span><span style=color:#ae81ff>0</span><span style=color:#111>)</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>k</span><span style=color:#111>)</span> <span style=color:#111>k</span><span style=color:#f92672>--</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>while</span> <span style=color:#111>(</span><span style=color:#111>s</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#f92672>+</span><span style=color:#111>k</span><span style=color:#111>]</span> <span style=color:#f92672>==</span> <span style=color:#111>s</span><span style=color:#111>[</span><span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>pos</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>]</span><span style=color:#f92672>+</span><span style=color:#111>k</span><span style=color:#111>])</span> <span style=color:#111>k</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
        <span style=color:#111>lcp</span><span style=color:#111>[</span><span style=color:#111>pos</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]]</span> <span style=color:#f92672>=</span> <span style=color:#111>k</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>
    <span style=color:#00a8c8>return</span> <span style=color:#111>lcp</span><span style=color:#111>;</span>
<span style=color:#111>}</span>

<span style=color:#00a8c8>int</span> <span style=color:#75af00>main</span><span style=color:#111>()</span> <span style=color:#111>{</span>
    <span style=color:#111>ios</span><span style=color:#f92672>::</span><span style=color:#111>sync_with_stdio</span><span style=color:#111>(</span><span style=color:#111>false</span><span style=color:#111>);</span>
    <span style=color:#111>cin</span><span style=color:#111>.</span><span style=color:#111>tie</span><span style=color:#111>(</span><span style=color:#00a8c8>nullptr</span><span style=color:#111>);</span>
    <span style=color:#111>string</span> <span style=color:#111>s</span><span style=color:#111>;</span>
    <span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>s</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>auto</span> <span style=color:#111>sa</span><span style=color:#f92672>=</span><span style=color:#111>suffix_array</span><span style=color:#111>(</span><span style=color:#111>s</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>auto</span> <span style=color:#111>lcp</span><span style=color:#f92672>=</span><span style=color:#111>build_lcp</span><span style=color:#111>(</span><span style=color:#111>s</span><span style=color:#111>,</span> <span style=color:#111>sa</span><span style=color:#111>);</span>
    <span style=color:#111>lcp</span><span style=color:#111>.</span><span style=color:#111>push_back</span><span style=color:#111>(</span><span style=color:#ae81ff>0</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#111>s</span><span style=color:#111>.</span><span style=color:#111>size</span><span style=color:#111>();</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>l</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>&lt;</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span><span style=color:#111>)</span><span style=color:#111>s</span><span style=color:#111>.</span><span style=color:#111>size</span><span style=color:#111>();</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>len</span><span style=color:#f92672>=</span><span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#111>lcp</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>],</span> <span style=color:#111>lcp</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>])</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#f92672>&gt;</span><span style=color:#111>s</span><span style=color:#111>.</span><span style=color:#111>size</span><span style=color:#111>()</span><span style=color:#f92672>-</span><span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>])</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#f92672>&lt;</span><span style=color:#111>ans</span><span style=color:#111>)</span> <span style=color:#111>{</span>
            <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#111>len</span><span style=color:#111>;</span>
            <span style=color:#111>l</span><span style=color:#f92672>=</span><span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>];</span>
        <span style=color:#111>}</span> <span style=color:#00a8c8>else</span> <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>len</span><span style=color:#f92672>==</span><span style=color:#111>ans</span><span style=color:#111>)</span> <span style=color:#111>l</span><span style=color:#f92672>=</span><span style=color:#111>min</span><span style=color:#111>(</span><span style=color:#111>l</span><span style=color:#111>,</span> <span style=color:#111>sa</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]);</span>
    <span style=color:#111>}</span>
    <span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#111>s</span><span style=color:#111>.</span><span style=color:#111>substr</span><span style=color:#111>(</span><span style=color:#111>l</span><span style=color:#111>,</span> <span style=color:#111>ans</span><span style=color:#111>);</span>
<span style=color:#111>}</span>
</code></pre></div><h2 id=solution-2-binary-search--string-hashing>Solution 2: Binary Search + String Hashing</h2><p>Note that if a substring is unique, then all the other substrings containing that substring is also unique. So we can binary search the length of the substring.</p><p>For each length, we check if there is a unique substring in all the substrings of that length using hashing. One way of calculating hash value of a substring efficiently is to precalculate hash value of all prefixes (like prefix sum). Note that in the implementation, we let the left position be more significant bit in order to avoid division.</p><p>Code:</p><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span><span style=color:#75715e></span><span style=color:#00a8c8>using</span> <span style=color:#00a8c8>namespace</span> <span style=color:#111>std</span><span style=color:#111>;</span>
<span style=color:#00a8c8>using</span> <span style=color:#111>ll</span> <span style=color:#f92672>=</span> <span style=color:#00a8c8>long</span> <span style=color:#00a8c8>long</span><span style=color:#111>;</span>

<span style=color:#00a8c8>int</span> <span style=color:#75af00>main</span><span style=color:#111>()</span> <span style=color:#111>{</span>
    <span style=color:#111>ios</span><span style=color:#f92672>::</span><span style=color:#111>sync_with_stdio</span><span style=color:#111>(</span><span style=color:#111>false</span><span style=color:#111>);</span>
    <span style=color:#111>cin</span><span style=color:#111>.</span><span style=color:#111>tie</span><span style=color:#111>(</span><span style=color:#00a8c8>nullptr</span><span style=color:#111>);</span>
    <span style=color:#111>string</span> <span style=color:#111>s</span><span style=color:#111>;</span>
    <span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>s</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>n</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span><span style=color:#111>)</span><span style=color:#111>s</span><span style=color:#111>.</span><span style=color:#111>size</span><span style=color:#111>();</span>
    <span style=color:#00a8c8>constexpr</span> <span style=color:#00a8c8>int</span> <span style=color:#111>mod</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1e9</span><span style=color:#f92672>+</span><span style=color:#ae81ff>7</span><span style=color:#111>;</span>
    <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#111>ll</span><span style=color:#f92672>&gt;</span> <span style=color:#111>pow</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>),</span> <span style=color:#111>ha</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>);</span>
    <span style=color:#111>pow</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>&lt;=</span><span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
        <span style=color:#111>pow</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#111>pow</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>]</span><span style=color:#f92672>*</span><span style=color:#ae81ff>233</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
        <span style=color:#111>ha</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#111>ha</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>]</span><span style=color:#f92672>*</span><span style=color:#ae81ff>233</span><span style=color:#f92672>+</span><span style=color:#111>s</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>])</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>
    <span style=color:#00a8c8>auto</span> <span style=color:#111>get_hash</span><span style=color:#f92672>=</span><span style=color:#111>[</span><span style=color:#f92672>&amp;</span><span style=color:#111>](</span><span style=color:#00a8c8>int</span> <span style=color:#111>l</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span> <span style=color:#111>r</span><span style=color:#111>)</span> <span style=color:#111>{</span>
        <span style=color:#111>l</span><span style=color:#f92672>++</span><span style=color:#111>,</span> <span style=color:#111>r</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>(</span><span style=color:#111>ha</span><span style=color:#111>[</span><span style=color:#111>r</span><span style=color:#111>]</span><span style=color:#f92672>-</span><span style=color:#111>ha</span><span style=color:#111>[</span><span style=color:#111>l</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>]</span><span style=color:#f92672>*</span><span style=color:#111>pow</span><span style=color:#111>[</span><span style=color:#111>r</span><span style=color:#f92672>-</span><span style=color:#111>l</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>]</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#f92672>+</span><span style=color:#111>mod</span><span style=color:#111>)</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
    <span style=color:#111>};</span>
    <span style=color:#00a8c8>auto</span> <span style=color:#111>check</span><span style=color:#f92672>=</span><span style=color:#111>[</span><span style=color:#f92672>&amp;</span><span style=color:#111>](</span><span style=color:#00a8c8>int</span> <span style=color:#111>len</span><span style=color:#111>)</span> <span style=color:#111>{</span>
        <span style=color:#111>unordered_map</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>cnt</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>+</span><span style=color:#111>len</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;</span><span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
            <span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>get_hash</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>i</span><span style=color:#f92672>+</span><span style=color:#111>len</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)]</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
        <span style=color:#111>}</span>
        <span style=color:#00a8c8>for</span> <span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>+</span><span style=color:#111>len</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;</span><span style=color:#111>n</span><span style=color:#111>;</span> <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>)</span> <span style=color:#111>{</span>
            <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>cnt</span><span style=color:#111>[</span><span style=color:#111>get_hash</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span> <span style=color:#111>i</span><span style=color:#f92672>+</span><span style=color:#111>len</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)]</span><span style=color:#f92672>==</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#00a8c8>return</span> <span style=color:#111>i</span><span style=color:#111>;</span>
        <span style=color:#111>}</span>
        <span style=color:#00a8c8>return</span> <span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
    <span style=color:#111>};</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>l</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span> <span style=color:#111>r</span><span style=color:#f92672>=</span><span style=color:#111>n</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>while</span> <span style=color:#111>(</span><span style=color:#111>l</span><span style=color:#f92672>&lt;=</span><span style=color:#111>r</span><span style=color:#111>)</span> <span style=color:#111>{</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>mid</span> <span style=color:#f92672>=</span> <span style=color:#111>(</span><span style=color:#111>l</span><span style=color:#f92672>+</span><span style=color:#111>r</span><span style=color:#111>)</span><span style=color:#f92672>/</span><span style=color:#ae81ff>2</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>if</span> <span style=color:#111>(</span><span style=color:#111>check</span><span style=color:#111>(</span><span style=color:#111>mid</span><span style=color:#111>)</span><span style=color:#f92672>!=-</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#111>{</span>
            <span style=color:#111>r</span><span style=color:#f92672>=</span><span style=color:#111>mid</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
        <span style=color:#111>}</span> <span style=color:#00a8c8>else</span> <span style=color:#111>{</span>
            <span style=color:#111>l</span><span style=color:#f92672>=</span><span style=color:#111>mid</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
        <span style=color:#111>}</span>
    <span style=color:#111>}</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#111>check</span><span style=color:#111>(</span><span style=color:#111>l</span><span style=color:#111>);</span>
    <span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#111>s</span><span style=color:#111>.</span><span style=color:#111>substr</span><span style=color:#111>(</span><span style=color:#111>ans</span><span style=color:#111>,</span> <span style=color:#111>l</span><span style=color:#111>);</span>
<span style=color:#111>}</span>
</code></pre></div><div class=blog-tags><a href=https://blog.tgc-thallium.com/tags/suffix-array/>Suffix Array</a>&nbsp;
<a href=https://blog.tgc-thallium.com/tags/binary-search/>Binary Search</a>&nbsp;
<a href=https://blog.tgc-thallium.com/tags/hashing/>Hashing</a>&nbsp;</div></article><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script><div id=gitalk-container></div><script>var gitalk=new Gitalk({clientID:'804f53fd87621403bf11',clientSecret:'5cfea89eac0c032eb02b333a1030d73e7b6e2176',repo:'blog',owner:'thallium',admin:['thallium'],id:location.pathname,distractionFreeMode:!1});gitalk.render('gitalk-container')</script></div><footer><div class=social-icons><a href=https://github.com/thallium name=GitHub><em class="fab fa-github"></em></a></div><div class=container><p class="credits copyright"><a href=https://blog.tgc-thallium.com/about>Gengchen</a>
&nbsp;&copy;
2021
&nbsp;/&nbsp;
<a href=https://blog.tgc-thallium.com/>Thallium's Blog</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>