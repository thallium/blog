<!doctype html><html lang=en><head><meta charset=utf-8><title>Solution for CodeForces 1312D - Count the Arrays</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://blog.tgc-thallium.com/index.xml title="Thallium's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Solution for CodeForces 1312D - Count the Arrays"><meta name=twitter:description content="My math is sh!t."><link rel=stylesheet href=https://blog.tgc-thallium.com/fontawesome/css/all.min.css><link rel=stylesheet href=https://blog.tgc-thallium.com/css/main.css><link id=dark-mode-theme rel=stylesheet href=https://blog.tgc-thallium.com/css/dark.css><script>var darkTheme=document.getElementById('dark-mode-theme'),storedTheme=localStorage.getItem('dark-mode-storage');storedTheme==='dark'?darkTheme.disabled=!1:storedTheme==='light'&&(darkTheme.disabled=!0)</script><script src=https://blog.tgc-thallium.com/js/main.bundle.js></script><script src=https://blog.tgc-thallium.com/js/instantpage.min.js type=module defer></script><meta name=generator content="Hugo 0.83.1"></head><body><header><nav class=navbar><div class=nav><p class=nav-logo><a href=https://blog.tgc-thallium.com/><u>en</u></a>
<a href=https://blog.tgc-thallium.com/zh-hans/><u>zh-hans</u></a></p><ul class=nav-links><li><a href=/ id=Home><em class="fas fa-home fa-lg"></em></a></li><li><a href=/about/ id=About><em class="fas fa-user fa-lg"></em></a></li><li><a href=/tags/ id=Tags><em class="fas fa-tag fa-lg"></em></a></li><li><a href=/categories/ id=Categories><em class="fas fa-list fa-lg"></em></a></li><li><a href=/archives/ id=Archives><em class="fas fa-archive fa-lg"></em></a></li><li><a href=/search/ id=Search><em class="fas fa-search fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=post-heading><h1>Solution for CodeForces 1312D - Count the Arrays</h1><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;Mar 10, 2020
&nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
<a href=https://blog.tgc-thallium.com/categories/solutions/>Solutions</a>&nbsp;</span></div></div></div></header><div class=container role=main><article class=article class=blog-post><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.css integrity=sha384-L+Gq2Cso/Y2x8fX4wausgiZT8z0QPZz7OqPuz4YqAycQJyrJT9NRLpjFBD6zlOia crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.js integrity=sha384-z64WtjpyrKFsxox9eI4SI8eM9toXdoYeWb5Qh+8PO+eG54Bv9BZqf9xNhlcLf/sA crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script><p>My math is sh!t.</p><p>Adapted from the original tutorial.</p><h1 id=solution>Solution</h1><p>First of all, there will be $n-1$ distinct elements in the array and there are $m\choose{n-1}$ways to choose.</p><p>Next, there are $n-2$ elements we could choose to duplicate. Finally, some elements will appear before the maximum and some will appear after. However, the duplicated elements will appear on both sides, so there are $2^{n-3}$ ways to choose their positions.</p><p>In summary, the answer is ${{m}\choose{n - 1}} (n - 2)2^{n - 3}$.</p><h1 id=code>Code</h1><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#75715e>#define forn(i, n) for (int i = 0; i &lt; int(n); ++i)
</span><span style=color:#75715e>#define for1(i, n) for (int i = 1; i &lt;= int(n); ++i)
</span><span style=color:#75715e>#define fore(i, l, r) for (int i = int(l); i &lt;= int(r); ++i)
</span><span style=color:#75715e>#define ford(i, n) for (int i = int(n)-1; i &gt;= 0; --i)
</span><span style=color:#75715e>#define pb push_back
</span><span style=color:#75715e>#define eb emplace_back
</span><span style=color:#75715e>#define ms(a, x) memset(a, x, sizeof(a))
</span><span style=color:#75715e>#define F first
</span><span style=color:#75715e>#define S second
</span><span style=color:#75715e>#define endl &#39;\n&#39;
</span><span style=color:#75715e>#define de(x) cout&lt;&lt;#x&lt;&lt;&#34; = &#34;&lt;&lt;(x)&lt;&lt;endl
</span><span style=color:#75715e>#define de2(x,y) cout&lt;&lt;#x&lt;&lt;&#34; = &#34;&lt;&lt;(x) &lt;&lt;&#39; &#39;&lt;&lt; #y&lt;&lt;&#34; = &#34;&lt;&lt;y&lt;&lt;endl;
</span><span style=color:#75715e></span>
<span style=color:#00a8c8>using</span> <span style=color:#00a8c8>namespace</span> <span style=color:#111>std</span><span style=color:#111>;</span>

<span style=color:#00a8c8>typedef</span> <span style=color:#00a8c8>long</span> <span style=color:#00a8c8>long</span> <span style=color:#111>ll</span><span style=color:#111>;</span>
<span style=color:#00a8c8>typedef</span> <span style=color:#111>pair</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>pii</span><span style=color:#111>;</span>
<span style=color:#00a8c8>const</span> <span style=color:#00a8c8>int</span> <span style=color:#111>INF</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x3f3f3f3f</span><span style=color:#111>;</span>
<span style=color:#111>mt19937</span> <span style=color:#75af00>gen</span><span style=color:#111>(</span><span style=color:#111>chrono</span><span style=color:#f92672>::</span><span style=color:#111>high_resolution_clock</span><span style=color:#f92672>::</span><span style=color:#111>now</span><span style=color:#111>().</span><span style=color:#111>time_since_epoch</span><span style=color:#111>().</span><span style=color:#111>count</span><span style=color:#111>());</span>

<span style=color:#00a8c8>const</span> <span style=color:#00a8c8>int</span> <span style=color:#111>mod</span><span style=color:#f92672>=</span><span style=color:#ae81ff>998244353</span><span style=color:#111>;</span>
<span style=color:#111>ll</span> <span style=color:#75af00>bipow</span><span style=color:#111>(</span><span style=color:#111>ll</span> <span style=color:#111>a</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>b</span><span style=color:#111>){</span>
	<span style=color:#111>ll</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
	<span style=color:#00a8c8>for</span><span style=color:#111>(;</span><span style=color:#111>b</span><span style=color:#111>;</span><span style=color:#111>b</span><span style=color:#f92672>&gt;&gt;=</span><span style=color:#ae81ff>1</span><span style=color:#111>){</span>
		<span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>b</span><span style=color:#f92672>&amp;</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#111>ans</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
		<span style=color:#111>a</span><span style=color:#f92672>=</span><span style=color:#111>a</span><span style=color:#f92672>*</span><span style=color:#111>a</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
	<span style=color:#111>}</span>
	<span style=color:#00a8c8>return</span> <span style=color:#111>ans</span><span style=color:#111>;</span>
<span style=color:#111>}</span>
<span style=color:#00a8c8>int</span> <span style=color:#75af00>main</span><span style=color:#111>()</span> <span style=color:#111>{</span>
    <span style=color:#111>ios</span><span style=color:#f92672>::</span><span style=color:#111>sync_with_stdio</span><span style=color:#111>(</span><span style=color:#111>false</span><span style=color:#111>);</span>
    <span style=color:#111>cin</span><span style=color:#111>.</span><span style=color:#111>tie</span><span style=color:#111>(</span><span style=color:#00a8c8>nullptr</span><span style=color:#111>);</span>
	<span style=color:#00a8c8>int</span> <span style=color:#111>n</span><span style=color:#111>,</span><span style=color:#111>m</span><span style=color:#111>;</span>
	<span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>n</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>m</span><span style=color:#111>;</span>
	<span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#f92672>==</span><span style=color:#ae81ff>2</span><span style=color:#111>)</span> <span style=color:#00a8c8>return</span> <span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span>
	<span style=color:#111>ll</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>r</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
	<span style=color:#111>for1</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span><span style=color:#111>m</span><span style=color:#111>)</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#111>ans</span><span style=color:#f92672>*</span><span style=color:#111>i</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
	<span style=color:#111>for1</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span><span style=color:#111>n</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#111>r</span><span style=color:#f92672>=</span><span style=color:#111>r</span><span style=color:#f92672>*</span><span style=color:#111>i</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
	<span style=color:#111>for1</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span><span style=color:#111>m</span><span style=color:#f92672>-</span><span style=color:#111>n</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#111>r</span><span style=color:#f92672>=</span><span style=color:#111>r</span><span style=color:#f92672>*</span><span style=color:#111>i</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
	<span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#111>ans</span><span style=color:#f92672>*</span><span style=color:#111>bipow</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>,</span><span style=color:#111>mod</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2</span><span style=color:#111>)</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#f92672>*</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#f92672>-</span><span style=color:#ae81ff>2</span><span style=color:#111>)</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
	<span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#111>ans</span><span style=color:#f92672>*</span><span style=color:#111>bipow</span><span style=color:#111>(</span><span style=color:#ae81ff>2</span><span style=color:#111>,</span><span style=color:#111>n</span><span style=color:#f92672>-</span><span style=color:#ae81ff>3</span><span style=color:#111>)</span><span style=color:#f92672>%</span><span style=color:#111>mod</span><span style=color:#111>;</span>
	<span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#111>ans</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>return</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
<span style=color:#111>}</span>
</code></pre></div><div class=blog-tags><a href=https://blog.tgc-thallium.com/tags/math/>Math</a>&nbsp;
<a href=https://blog.tgc-thallium.com/tags/combinatorics/>Combinatorics</a>&nbsp;</div></article></div><footer><div class=social-icons><a href=https://github.com/thallium name=GitHub><em class="fab fa-github"></em></a></div><div class=container><p class="credits copyright"><a href=https://blog.tgc-thallium.com/about>Gengchen</a>
&nbsp;&copy;
2021
&nbsp;/&nbsp;
<a href=https://blog.tgc-thallium.com/>Thallium's Blog</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>