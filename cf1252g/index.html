<!doctype html><html lang=en><head><meta charset=utf-8><title>Solution for Codeforces 1252G - Performance Review</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://blog.tgc-thallium.com/index.xml title="Thallium's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Solution for Codeforces 1252G - Performance Review"><meta name=twitter:description content><link rel=stylesheet href=https://blog.tgc-thallium.com/fontawesome/css/all.min.css><link rel=stylesheet href=https://blog.tgc-thallium.com/css/main.css><link id=dark-mode-theme rel=stylesheet href=https://blog.tgc-thallium.com/css/dark.css><script>var darkTheme=document.getElementById('dark-mode-theme'),storedTheme=localStorage.getItem('dark-mode-storage');storedTheme==='dark'?darkTheme.disabled=!1:storedTheme==='light'&&(darkTheme.disabled=!0)</script><script src=https://blog.tgc-thallium.com/js/main.bundle.js></script><script src=https://blog.tgc-thallium.com/js/instantpage.min.js type=module defer></script><meta name=generator content="Hugo 0.83.1"></head><body><header><nav class=navbar><div class=nav><p class=lang><i class="fas fa-globe"></i>
<a href=https://blog.tgc-thallium.com/zh-hans/ title="no translation">中文</a></p><ul class=nav-links><li><a href=/ id=Home title=Home><em class="fas fa-home fa-lg"></em></a></li><li><a href=/about/ id=About title=About><em class="fas fa-user fa-lg"></em></a></li><li><a href=/tags/ id=Tags title=Tags><em class="fas fa-tag fa-lg"></em></a></li><li><a href=/categories/ id=Categories title=Categories><em class="fas fa-list fa-lg"></em></a></li><li><a href=/archives/ id=Archives title=Archives><em class="fas fa-archive fa-lg"></em></a></li><li><a href=/search/ id=Search title=Search><em class="fas fa-search fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=post-heading><h1>Solution for Codeforces 1252G - Performance Review</h1><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;Jun 9, 2020
&nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
<a href=https://blog.tgc-thallium.com/categories/solutions/>Solutions</a>&nbsp;</span></div></div></div></header><div class=container role=main><article class=article class=blog-post><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.css integrity=sha384-L+Gq2Cso/Y2x8fX4wausgiZT8z0QPZz7OqPuz4YqAycQJyrJT9NRLpjFBD6zlOia crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.js integrity=sha384-z64WtjpyrKFsxox9eI4SI8eM9toXdoYeWb5Qh+8PO+eG54Bv9BZqf9xNhlcLf/sA crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script><aside><nav id=TableOfContents><ul><li><a href=#solution>Solution</a></li><li><a href=#code>Code</a></li></ul></nav></aside><h2 id=solution>Solution</h2><p>All &ldquo;worse&rdquo; and &ldquo;better&rdquo; are used to describe the performance compared to Randall.</p><p>First observation is that if Randall will be in the company after $M$ years, only employees with worse performance can be replaced. So for each year we only need to check whether the number of people with worse performance minus the number of replaced employee is greater er of equal than zero. Let $R_i$ be the number of people with worse performance minus the number of replaced employee after the $i$-th year. The initial $R$ array can be constructed naively.</p><p>Now let&rsquo;s consider how the $R$ array changes after each modification. There are four case:</p><ol><li><p>A worse employee remains worse.</p></li><li><p>A worse employee becomes better.</p></li><li><p>A better employee becomes worse.</p></li><li><p>A better employee remains better.</p></li></ol><p>Obviously, for the first and the fourth case $R$ array doesn&rsquo;t change. For the second case, the number of worse employees decrease by 1 starting from the next year and for the third case, the number of worse employees increase by 1. That is to say, for case 2, $R_i$ decrease by one starting from the next year, for case 3, $R_i$ increase by one starting from the next year. So what we need is a data structure that supports range updates and global min value query. We can use a segment tree.</p><h2 id=code>Code</h2><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span>
<span style=color:#75715e>#define forn(i, n) for (int i = 0; i &lt; int(n); ++i)
</span><span style=color:#75715e>#define for1(i, n) for (int i = 1; i &lt;= int(n); ++i)
</span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span><span style=color:#75715e>#define pb push_back
</span><span style=color:#75715e></span>
<span style=color:#00a8c8>using</span> <span style=color:#00a8c8>namespace</span> <span style=color:#111>std</span><span style=color:#111>;</span>
<span style=color:#00a8c8>using</span> <span style=color:#111>ll</span><span style=color:#f92672>=</span><span style=color:#00a8c8>long</span> <span style=color:#00a8c8>long</span><span style=color:#111>;</span>
<span style=color:#00a8c8>template</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>typename</span><span style=color:#111>...</span> <span style=color:#111>T</span><span style=color:#f92672>&gt;</span> <span style=color:#00a8c8>void</span> <span style=color:#111>rd</span><span style=color:#111>(</span><span style=color:#111>T</span><span style=color:#f92672>&amp;</span><span style=color:#111>...</span> <span style=color:#111>args</span><span style=color:#111>)</span> <span style=color:#111>{((</span><span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>args</span><span style=color:#111>),</span> <span style=color:#111>...);}</span>

<span style=color:#00a8c8>struct</span> <span style=color:#75af00>SegTree</span><span style=color:#111>{</span>
    <span style=color:#75715e>// remember to change the type and pushup function
</span><span style=color:#75715e></span>    <span style=color:#00a8c8>int</span> <span style=color:#111>n</span><span style=color:#111>;</span>
    <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>t</span><span style=color:#111>,</span><span style=color:#111>lazy</span><span style=color:#111>;</span>
    <span style=color:#111>SegTree</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>n_</span><span style=color:#111>)</span><span style=color:#f92672>:</span><span style=color:#111>n</span><span style=color:#111>(</span><span style=color:#111>n_</span><span style=color:#111>),</span><span style=color:#111>t</span><span style=color:#111>(</span><span style=color:#ae81ff>4</span><span style=color:#f92672>*</span><span style=color:#111>n</span><span style=color:#111>),</span><span style=color:#111>lazy</span><span style=color:#111>(</span><span style=color:#ae81ff>4</span><span style=color:#f92672>*</span><span style=color:#111>n</span><span style=color:#111>){}</span>
    <span style=color:#111>SegTree</span><span style=color:#111>(</span><span style=color:#00a8c8>const</span> <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;&amp;</span> <span style=color:#111>v</span><span style=color:#111>)</span><span style=color:#f92672>:</span><span style=color:#111>SegTree</span><span style=color:#111>((</span><span style=color:#00a8c8>int</span><span style=color:#111>)</span><span style=color:#111>v</span><span style=color:#111>.</span><span style=color:#111>size</span><span style=color:#111>()){</span>
        <span style=color:#111>build</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#111>n</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>v</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>
    <span style=color:#00a8c8>void</span> <span style=color:#75af00>pushup</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>node</span><span style=color:#111>){</span>
        <span style=color:#111>t</span><span style=color:#111>[</span><span style=color:#111>node</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#111>min</span><span style=color:#111>(</span><span style=color:#111>t</span><span style=color:#111>[</span><span style=color:#111>node</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#111>],</span><span style=color:#111>t</span><span style=color:#111>[</span><span style=color:#111>node</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#f92672>|</span><span style=color:#ae81ff>1</span><span style=color:#111>]);</span>
    <span style=color:#111>}</span>
    <span style=color:#00a8c8>void</span> <span style=color:#75af00>build</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>node</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>l</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span><span style=color:#111>,</span><span style=color:#00a8c8>const</span> <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;&amp;</span> <span style=color:#111>v</span><span style=color:#111>){</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>l</span><span style=color:#f92672>==</span><span style=color:#111>r</span><span style=color:#111>){</span>
            <span style=color:#111>t</span><span style=color:#111>[</span><span style=color:#111>node</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#111>v</span><span style=color:#111>[</span><span style=color:#111>l</span><span style=color:#111>];</span>
            <span style=color:#00a8c8>return</span><span style=color:#111>;</span>
        <span style=color:#111>}</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>mid</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#111>l</span><span style=color:#f92672>+</span><span style=color:#111>r</span><span style=color:#111>)</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
        <span style=color:#111>build</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>l</span><span style=color:#111>,</span><span style=color:#111>mid</span><span style=color:#111>,</span><span style=color:#111>v</span><span style=color:#111>);</span>
        <span style=color:#111>build</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#f92672>|</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>mid</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>r</span><span style=color:#111>,</span><span style=color:#111>v</span><span style=color:#111>);</span>
        <span style=color:#111>pushup</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>
    <span style=color:#00a8c8>void</span> <span style=color:#75af00>addtag</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>p</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>x</span><span style=color:#111>){</span>
        <span style=color:#111>t</span><span style=color:#111>[</span><span style=color:#111>p</span><span style=color:#111>]</span><span style=color:#f92672>+=</span><span style=color:#111>x</span><span style=color:#111>;</span>
        <span style=color:#111>lazy</span><span style=color:#111>[</span><span style=color:#111>p</span><span style=color:#111>]</span><span style=color:#f92672>+=</span><span style=color:#111>x</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>
    <span style=color:#00a8c8>void</span> <span style=color:#75af00>spread</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>p</span><span style=color:#111>){</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>lazy</span><span style=color:#111>[</span><span style=color:#111>p</span><span style=color:#111>]){</span>
            <span style=color:#111>addtag</span><span style=color:#111>(</span><span style=color:#111>p</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>lazy</span><span style=color:#111>[</span><span style=color:#111>p</span><span style=color:#111>]);</span>
            <span style=color:#111>addtag</span><span style=color:#111>(</span><span style=color:#111>p</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#f92672>|</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>lazy</span><span style=color:#111>[</span><span style=color:#111>p</span><span style=color:#111>]);</span>
            <span style=color:#111>lazy</span><span style=color:#111>[</span><span style=color:#111>p</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span>
        <span style=color:#111>}</span>
    <span style=color:#111>}</span>
    <span style=color:#00a8c8>void</span> <span style=color:#75af00>update</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>node</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>ql</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>qr</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>l</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>x</span><span style=color:#111>){</span>
        <span style=color:#111>assert</span><span style=color:#111>(</span><span style=color:#111>ql</span><span style=color:#f92672>&lt;=</span><span style=color:#111>qr</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>ql</span><span style=color:#f92672>&lt;=</span><span style=color:#111>l</span><span style=color:#f92672>&amp;&amp;</span><span style=color:#111>qr</span><span style=color:#f92672>&gt;=</span><span style=color:#111>r</span><span style=color:#111>){</span>
            <span style=color:#111>addtag</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>,</span><span style=color:#111>x</span><span style=color:#111>);</span>
            <span style=color:#00a8c8>return</span><span style=color:#111>;</span>
        <span style=color:#111>}</span>
        <span style=color:#111>spread</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>mid</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#111>l</span><span style=color:#f92672>+</span><span style=color:#111>r</span><span style=color:#111>)</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>ql</span><span style=color:#f92672>&lt;=</span><span style=color:#111>mid</span><span style=color:#111>)</span> <span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>ql</span><span style=color:#111>,</span><span style=color:#111>qr</span><span style=color:#111>,</span><span style=color:#111>l</span><span style=color:#111>,</span><span style=color:#111>mid</span><span style=color:#111>,</span><span style=color:#111>x</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>qr</span><span style=color:#f92672>&gt;</span><span style=color:#111>mid</span><span style=color:#111>)</span> <span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#f92672>|</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>ql</span><span style=color:#111>,</span><span style=color:#111>qr</span><span style=color:#111>,</span><span style=color:#111>mid</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>r</span><span style=color:#111>,</span><span style=color:#111>x</span><span style=color:#111>);</span>
        <span style=color:#111>pushup</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>

    <span style=color:#111>ll</span> <span style=color:#75af00>query</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>node</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>ql</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>qr</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>l</span><span style=color:#111>,</span><span style=color:#00a8c8>int</span> <span style=color:#111>r</span><span style=color:#111>){</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>ql</span><span style=color:#f92672>&lt;=</span><span style=color:#111>l</span><span style=color:#f92672>&amp;&amp;</span><span style=color:#111>qr</span><span style=color:#f92672>&gt;=</span><span style=color:#111>r</span><span style=color:#111>)</span> <span style=color:#00a8c8>return</span> <span style=color:#111>t</span><span style=color:#111>[</span><span style=color:#111>node</span><span style=color:#111>];</span>
        <span style=color:#111>spread</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>mid</span><span style=color:#f92672>=</span><span style=color:#111>(</span><span style=color:#111>l</span><span style=color:#f92672>+</span><span style=color:#111>r</span><span style=color:#111>)</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span>
        <span style=color:#111>ll</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1e18</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>ql</span><span style=color:#f92672>&lt;=</span><span style=color:#111>mid</span><span style=color:#111>)</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#111>min</span><span style=color:#111>(</span><span style=color:#111>ans</span><span style=color:#111>,</span><span style=color:#111>query</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>ql</span><span style=color:#111>,</span><span style=color:#111>qr</span><span style=color:#111>,</span><span style=color:#111>l</span><span style=color:#111>,</span><span style=color:#111>mid</span><span style=color:#111>));</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>qr</span><span style=color:#f92672>&gt;</span><span style=color:#111>mid</span><span style=color:#111>)</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#111>min</span><span style=color:#111>(</span><span style=color:#111>ans</span><span style=color:#111>,</span><span style=color:#111>query</span><span style=color:#111>(</span><span style=color:#111>node</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#f92672>|</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>ql</span><span style=color:#111>,</span><span style=color:#111>qr</span><span style=color:#111>,</span><span style=color:#111>mid</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>r</span><span style=color:#111>));</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>ans</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>
    <span style=color:#111>ll</span> <span style=color:#75af00>query</span><span style=color:#111>(){</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>query</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#111>n</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#111>n</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>
<span style=color:#111>};</span>
<span style=color:#00a8c8>int</span> <span style=color:#75af00>main</span><span style=color:#111>()</span> <span style=color:#111>{</span>
    <span style=color:#111>ios</span><span style=color:#f92672>::</span><span style=color:#111>sync_with_stdio</span><span style=color:#111>(</span><span style=color:#111>false</span><span style=color:#111>);</span>
    <span style=color:#111>cin</span><span style=color:#111>.</span><span style=color:#111>tie</span><span style=color:#111>(</span><span style=color:#00a8c8>nullptr</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>n</span><span style=color:#111>,</span><span style=color:#111>M</span><span style=color:#111>,</span><span style=color:#111>Q</span><span style=color:#111>;</span>
    <span style=color:#111>rd</span><span style=color:#111>(</span> <span style=color:#111>n</span><span style=color:#111>,</span><span style=color:#111>M</span><span style=color:#111>,</span><span style=color:#111>Q</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>better</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#111>worse</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span>
    <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>a</span><span style=color:#111>(</span><span style=color:#111>n</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>auto</span><span style=color:#f92672>&amp;</span> <span style=color:#111>it</span><span style=color:#111>:</span><span style=color:#111>a</span><span style=color:#111>){</span>
        <span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>it</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>it</span><span style=color:#f92672>&gt;=</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span> <span style=color:#111>better</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>else</span> <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>it</span><span style=color:#f92672>&lt;</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span> <span style=color:#111>worse</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>
    <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>r</span><span style=color:#111>(</span><span style=color:#111>M</span><span style=color:#111>);</span>
    <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;&gt;</span> <span style=color:#111>B</span><span style=color:#111>(</span><span style=color:#111>M</span><span style=color:#111>);</span>
    <span style=color:#111>forn</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span><span style=color:#111>M</span><span style=color:#111>){</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>R</span><span style=color:#111>;</span>
        <span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>R</span><span style=color:#111>;</span>
        <span style=color:#111>B</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>].</span><span style=color:#111>resize</span><span style=color:#111>(</span><span style=color:#111>R</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>bet</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#111>wor</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>auto</span><span style=color:#f92672>&amp;</span> <span style=color:#111>x</span><span style=color:#111>:</span><span style=color:#111>B</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]){</span>
            <span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>x</span><span style=color:#111>;</span>
            <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#f92672>&gt;</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span> <span style=color:#111>bet</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
            <span style=color:#00a8c8>else</span> <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#f92672>&lt;</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>])</span> <span style=color:#111>wor</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
        <span style=color:#111>}</span>
        <span style=color:#111>r</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#111>n</span><span style=color:#f92672>-</span><span style=color:#111>R</span><span style=color:#f92672>-</span><span style=color:#111>(</span><span style=color:#111>better</span><span style=color:#111>);</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>wor_removed</span><span style=color:#f92672>=</span><span style=color:#111>min</span><span style=color:#111>(</span><span style=color:#111>worse</span><span style=color:#111>,</span><span style=color:#111>R</span><span style=color:#111>);</span>
        <span style=color:#111>worse</span><span style=color:#f92672>-=</span><span style=color:#111>wor_removed</span><span style=color:#111>,</span><span style=color:#111>R</span><span style=color:#f92672>-=</span><span style=color:#111>wor_removed</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>bet_removed</span><span style=color:#f92672>=</span><span style=color:#111>min</span><span style=color:#111>(</span><span style=color:#111>R</span><span style=color:#111>,</span><span style=color:#111>better</span><span style=color:#111>);</span>
        <span style=color:#111>better</span><span style=color:#f92672>-=</span><span style=color:#111>bet_removed</span><span style=color:#111>;</span>
        <span style=color:#111>worse</span><span style=color:#f92672>+=</span><span style=color:#111>wor</span><span style=color:#111>,</span><span style=color:#111>better</span><span style=color:#f92672>+=</span><span style=color:#111>bet</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>
    <span style=color:#111>SegTree</span> <span style=color:#111>st</span><span style=color:#111>(</span><span style=color:#111>r</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>while</span><span style=color:#111>(</span><span style=color:#111>Q</span><span style=color:#f92672>--</span><span style=color:#111>){</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>x</span><span style=color:#111>,</span><span style=color:#111>y</span><span style=color:#111>,</span><span style=color:#111>z</span><span style=color:#111>;</span>
        <span style=color:#111>rd</span><span style=color:#111>(</span> <span style=color:#111>x</span><span style=color:#111>,</span><span style=color:#111>y</span><span style=color:#111>,</span><span style=color:#111>z</span><span style=color:#111>);</span>
        <span style=color:#111>x</span><span style=color:#f92672>--</span><span style=color:#111>,</span><span style=color:#111>y</span><span style=color:#f92672>--</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>B</span><span style=color:#111>[</span><span style=color:#111>x</span><span style=color:#111>][</span><span style=color:#111>y</span><span style=color:#111>]</span><span style=color:#f92672>&lt;</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span><span style=color:#f92672>&amp;&amp;</span><span style=color:#111>z</span><span style=color:#f92672>&gt;</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>]){</span>
            <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;=</span><span style=color:#111>M</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#111>st</span><span style=color:#111>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>x</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>M</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#111>M</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>);</span>
        <span style=color:#111>}</span><span style=color:#00a8c8>else</span> <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>B</span><span style=color:#111>[</span><span style=color:#111>x</span><span style=color:#111>][</span><span style=color:#111>y</span><span style=color:#111>]</span><span style=color:#f92672>&gt;</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>]</span><span style=color:#f92672>&amp;&amp;</span><span style=color:#111>z</span><span style=color:#f92672>&lt;</span><span style=color:#111>a</span><span style=color:#111>[</span><span style=color:#ae81ff>0</span><span style=color:#111>]){</span>
            <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>x</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;=</span><span style=color:#111>M</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span> <span style=color:#111>st</span><span style=color:#111>.</span><span style=color:#111>update</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>x</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>M</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>0</span><span style=color:#111>,</span><span style=color:#111>M</span><span style=color:#f92672>-</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#ae81ff>1</span><span style=color:#111>);</span>
        <span style=color:#111>}</span>
        <span style=color:#111>B</span><span style=color:#111>[</span><span style=color:#111>x</span><span style=color:#111>][</span><span style=color:#111>y</span><span style=color:#111>]</span><span style=color:#f92672>=</span><span style=color:#111>z</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>st</span><span style=color:#111>.</span><span style=color:#111>query</span><span style=color:#111>()</span><span style=color:#f92672>&gt;=</span><span style=color:#ae81ff>0</span><span style=color:#111>)</span> <span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>1</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#111>endl</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>else</span> <span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#ae81ff>0</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#111>endl</span><span style=color:#111>;</span>
    <span style=color:#111>}</span>
    <span style=color:#00a8c8>return</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>

<span style=color:#111>}</span>
</code></pre></div><div class=blog-tags><a href=https://blog.tgc-thallium.com/tags/data-structure/>Data Structure</a>&nbsp;
<a href=https://blog.tgc-thallium.com/tags/segment-tree/>Segment Tree</a>&nbsp;</div></article><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css><script src=https://cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js></script><div id=gitalk-container></div><script>var gitalk=new Gitalk({clientID:'804f53fd87621403bf11',clientSecret:'5cfea89eac0c032eb02b333a1030d73e7b6e2176',repo:'blog',owner:'thallium',admin:['thallium'],id:location.pathname,distractionFreeMode:!1});gitalk.render('gitalk-container')</script></div><footer><div class=social-icons><a href=https://github.com/thallium name=GitHub><em class="fab fa-github"></em></a></div><div class=container><p class="credits copyright"><a href=https://blog.tgc-thallium.com/about>Gengchen</a>
&nbsp;&copy;
2021
&nbsp;/&nbsp;
<a href=https://blog.tgc-thallium.com/>Thallium's Blog</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>