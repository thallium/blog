<!doctype html><html lang=en><head><meta charset=utf-8><title>Tutorial for Codeforces 762E - Radio stations</title><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><link rel=alternate type=application/rss+xml href=https://blog.tgc-thallium.com/index.xml title="Thallium's Blog"><meta name=twitter:card content="summary"><meta name=twitter:title content="Tutorial for Codeforces 762E - Radio stations"><meta name=twitter:description content><link rel=stylesheet href=https://blog.tgc-thallium.com/fontawesome/css/all.min.css><link rel=stylesheet href=https://blog.tgc-thallium.com/css/main.css><link id=dark-mode-theme rel=stylesheet href=https://blog.tgc-thallium.com/css/dark.css><script>var darkTheme=document.getElementById('dark-mode-theme'),storedTheme=localStorage.getItem('dark-mode-storage');storedTheme==='dark'?darkTheme.disabled=!1:storedTheme==='light'&&(darkTheme.disabled=!0)</script><script src=https://blog.tgc-thallium.com/js/main.bundle.js></script><script src=https://blog.tgc-thallium.com/js/instantpage.min.js type=module defer></script><meta name=generator content="Hugo 0.83.1"></head><body><header><nav class=navbar><div class=nav><p class=nav-logo>Lang:
<a href=https://blog.tgc-thallium.com/zh-hans/ title=中文(Home)><u>zh-hans</u></a></p><ul class=nav-links><li><a href=/ id=Home title=Home><em class="fas fa-home fa-lg"></em></a></li><li><a href=/about/ id=About title=About><em class="fas fa-user fa-lg"></em></a></li><li><a href=/tags/ id=Tags title=Tags><em class="fas fa-tag fa-lg"></em></a></li><li><a href=/categories/ id=Categories title=Categories><em class="fas fa-list fa-lg"></em></a></li><li><a href=/archives/ id=Archives title=Archives><em class="fas fa-archive fa-lg"></em></a></li><li><a href=/search/ id=Search title=Search><em class="fas fa-search fa-lg"></em></a></li></ul></div></nav><div class=intro-header><div class=container><div class=post-heading><h1>Tutorial for Codeforces 762E - Radio stations</h1><span class=meta-post><em class="fa fa-calendar-alt"></em>&nbsp;May 20, 2020
&nbsp;&nbsp;&nbsp;<em class="fa fa-folder-open"></em>&nbsp;
<a href=https://blog.tgc-thallium.com/categories/solutions/>Solutions</a>&nbsp;</span></div></div></div></header><div class=container role=main><article class=article class=blog-post><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.css integrity=sha384-L+Gq2Cso/Y2x8fX4wausgiZT8z0QPZz7OqPuz4YqAycQJyrJT9NRLpjFBD6zlOia crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/katex.min.js integrity=sha384-z64WtjpyrKFsxox9eI4SI8eM9toXdoYeWb5Qh+8PO+eG54Bv9BZqf9xNhlcLf/sA crossorigin=anonymous></script><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.5/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous></script><script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:'$$',right:'$$',display:!0},{left:'$',right:'$',display:!1},{left:'\\(',right:'\\)',display:!1},{left:'\\[',right:'\\]',display:!0}],throwOnError:!1})})</script><h2 id=solution>Solution</h2><p>Iterate over each frequency. Suppose now we are on frequency $i$. Put all stations with frequency $i$ in the $left$ vector and all radio stations with frequency $[i-k,i+k]$ into the $right$ vector.</p><p>Now we want to calculate the number of pairs such that the left radio station is from the $left$ vector and the right station is from $right$ vector.</p><p>Sort the $left$ vector by position and sort the $right$ vector by the left bound of the stations' range. Iterator the stations in the $left$ vector and put all the stations in the $right$ vector which can reach the current station in the axis(actually we need to put them in some data structure). Now we need to know how many stations in the axis can be reached by the current station. This can be done with some range-sum-query data structure(like fenwick tree): we add one on the position for each new station and use range query to find the stations we want. However, since the positions are up to $10^9$ we also need to compress the coordinate, which is really annoying, so a simpler way to do this is to use a balanced BST in pb_ds library to find the order directly.</p><p>The lesson learnt is that when we want to find the order, especially with coordinate compression, consider pb_ds.</p><h2 id=code>Code</h2><div class=highlight><pre style=color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-cpp data-lang=cpp><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;bits/stdc++.h&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ext/pb_ds/assoc_container.hpp&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span> <span style=color:#75715e>&lt;ext/pb_ds/tree_policy.hpp&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e>#include</span><span style=color:#75715e>&lt;ext/pb_ds/priority_queue.hpp&gt;</span><span style=color:#75715e>
</span><span style=color:#75715e></span><span style=color:#00a8c8>using</span> <span style=color:#00a8c8>namespace</span> <span style=color:#111>__gnu_pbds</span><span style=color:#111>;</span>

<span style=color:#75715e>#define forn(i, n) for (int i = 0; i &lt; int(n); ++i)
</span><span style=color:#75715e>#define for1(i, n) for (int i = 1; i &lt;= int(n); ++i)
</span><span style=color:#75715e>#define ms(a, x) memset(a, x, sizeof(a))
</span><span style=color:#75715e>#define F first
</span><span style=color:#75715e>#define S second
</span><span style=color:#75715e>#define all(x) (x).begin(),(x).end()
</span><span style=color:#75715e>#define pb push_back
</span><span style=color:#75715e></span>
<span style=color:#00a8c8>using</span> <span style=color:#00a8c8>namespace</span> <span style=color:#111>std</span><span style=color:#111>;</span>
<span style=color:#00a8c8>typedef</span> <span style=color:#00a8c8>long</span> <span style=color:#00a8c8>long</span> <span style=color:#111>ll</span><span style=color:#111>;</span>
<span style=color:#00a8c8>typedef</span> <span style=color:#111>pair</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#111>,</span> <span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span> <span style=color:#111>pii</span><span style=color:#111>;</span>
<span style=color:#00a8c8>const</span> <span style=color:#00a8c8>int</span> <span style=color:#111>INF</span> <span style=color:#f92672>=</span> <span style=color:#ae81ff>0x3f3f3f3f</span><span style=color:#111>;</span>
<span style=color:#111>mt19937</span> <span style=color:#75af00>gen</span><span style=color:#111>(</span><span style=color:#111>chrono</span><span style=color:#f92672>::</span><span style=color:#111>steady_clock</span><span style=color:#f92672>::</span><span style=color:#111>now</span><span style=color:#111>().</span><span style=color:#111>time_since_epoch</span><span style=color:#111>().</span><span style=color:#111>count</span><span style=color:#111>());</span>
<span style=color:#00a8c8>template</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>typename</span><span style=color:#111>...</span> <span style=color:#111>T</span><span style=color:#f92672>&gt;</span> <span style=color:#00a8c8>void</span> <span style=color:#111>rd</span><span style=color:#111>(</span><span style=color:#111>T</span><span style=color:#f92672>&amp;</span><span style=color:#111>...</span> <span style=color:#111>args</span><span style=color:#111>)</span> <span style=color:#111>{((</span><span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>args</span><span style=color:#111>),</span> <span style=color:#111>...);}</span>
<span style=color:#00a8c8>template</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>typename</span><span style=color:#111>...</span> <span style=color:#111>T</span><span style=color:#f92672>&gt;</span> <span style=color:#00a8c8>void</span> <span style=color:#111>wr</span><span style=color:#111>(</span><span style=color:#111>T</span><span style=color:#111>...</span> <span style=color:#111>args</span><span style=color:#111>)</span> <span style=color:#111>{((</span><span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#111>args</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#d88200>&#34; &#34;</span><span style=color:#111>),</span> <span style=color:#111>...);</span><span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#111>endl</span><span style=color:#111>;}</span>

<span style=color:#00a8c8>using</span> <span style=color:#111>ordered_set</span> <span style=color:#f92672>=</span> <span style=color:#111>tree</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#111>,</span> <span style=color:#111>null_type</span><span style=color:#111>,</span> <span style=color:#111>less</span><span style=color:#f92672>&lt;</span><span style=color:#00a8c8>int</span><span style=color:#f92672>&gt;</span><span style=color:#111>,</span> <span style=color:#111>rb_tree_tag</span><span style=color:#111>,</span> <span style=color:#111>tree_order_statistics_node_update</span><span style=color:#f92672>&gt;</span><span style=color:#111>;</span>
<span style=color:#00a8c8>int</span> <span style=color:#75af00>main</span><span style=color:#111>()</span> <span style=color:#111>{</span>
    <span style=color:#111>ios</span><span style=color:#f92672>::</span><span style=color:#111>sync_with_stdio</span><span style=color:#111>(</span><span style=color:#111>false</span><span style=color:#111>);</span>
    <span style=color:#111>cin</span><span style=color:#111>.</span><span style=color:#111>tie</span><span style=color:#111>(</span><span style=color:#00a8c8>nullptr</span><span style=color:#111>);</span>
    <span style=color:#00a8c8>int</span> <span style=color:#111>n</span><span style=color:#111>,</span><span style=color:#111>k</span><span style=color:#111>;</span>
    <span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>n</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>k</span><span style=color:#111>;</span>
    <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#111>pii</span><span style=color:#f92672>&gt;</span> <span style=color:#111>fre</span><span style=color:#111>[</span><span style=color:#ae81ff>10005</span><span style=color:#111>];</span>
    <span style=color:#111>forn</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#111>,</span><span style=color:#111>n</span><span style=color:#111>){</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>x</span><span style=color:#111>,</span><span style=color:#111>r</span><span style=color:#111>,</span><span style=color:#111>f</span><span style=color:#111>;</span>
        <span style=color:#111>cin</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>x</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>r</span><span style=color:#f92672>&gt;&gt;</span><span style=color:#111>f</span><span style=color:#111>;</span>
        <span style=color:#111>fre</span><span style=color:#111>[</span><span style=color:#111>f</span><span style=color:#111>].</span><span style=color:#111>pb</span><span style=color:#111>({</span><span style=color:#111>x</span><span style=color:#111>,</span><span style=color:#111>r</span><span style=color:#111>});</span>
    <span style=color:#111>}</span>
    <span style=color:#111>ll</span> <span style=color:#111>ans</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>auto</span> <span style=color:#111>solve</span><span style=color:#f92672>=</span><span style=color:#111>[</span><span style=color:#f92672>&amp;</span><span style=color:#111>](</span><span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#111>pii</span><span style=color:#f92672>&gt;&amp;</span> <span style=color:#111>left</span><span style=color:#111>,</span><span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#111>pii</span><span style=color:#f92672>&gt;&amp;</span> <span style=color:#111>right</span><span style=color:#111>){</span>
        <span style=color:#111>sort</span><span style=color:#111>(</span><span style=color:#111>all</span><span style=color:#111>(</span><span style=color:#111>left</span><span style=color:#111>));</span>
        <span style=color:#111>sort</span><span style=color:#111>(</span><span style=color:#111>all</span><span style=color:#111>(</span><span style=color:#111>right</span><span style=color:#111>),[](</span><span style=color:#111>pii</span> <span style=color:#111>a</span><span style=color:#111>,</span><span style=color:#111>pii</span> <span style=color:#111>b</span><span style=color:#111>){</span><span style=color:#00a8c8>return</span> <span style=color:#111>a</span><span style=color:#111>.</span><span style=color:#111>F</span><span style=color:#f92672>-</span><span style=color:#111>a</span><span style=color:#111>.</span><span style=color:#111>S</span><span style=color:#f92672>&lt;</span><span style=color:#111>b</span><span style=color:#111>.</span><span style=color:#111>F</span><span style=color:#f92672>-</span><span style=color:#111>b</span><span style=color:#111>.</span><span style=color:#111>S</span><span style=color:#111>;});</span>
        <span style=color:#111>ll</span> <span style=color:#111>res</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>int</span> <span style=color:#111>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>0</span><span style=color:#111>;</span>
        <span style=color:#111>ordered_set</span> <span style=color:#111>tree</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>auto</span> <span style=color:#111>it</span><span style=color:#111>:</span><span style=color:#111>left</span><span style=color:#111>){</span>
            <span style=color:#00a8c8>while</span><span style=color:#111>(</span><span style=color:#111>i</span><span style=color:#f92672>&lt;</span><span style=color:#111>right</span><span style=color:#111>.</span><span style=color:#111>size</span><span style=color:#111>()</span><span style=color:#f92672>&amp;&amp;</span><span style=color:#111>right</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>].</span><span style=color:#111>F</span><span style=color:#f92672>-</span><span style=color:#111>right</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>].</span><span style=color:#111>S</span><span style=color:#f92672>&lt;=</span><span style=color:#111>it</span><span style=color:#111>.</span><span style=color:#111>F</span><span style=color:#111>){</span>
                <span style=color:#111>tree</span><span style=color:#111>.</span><span style=color:#111>insert</span><span style=color:#111>(</span><span style=color:#111>right</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>].</span><span style=color:#111>F</span><span style=color:#111>);</span>
                <span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>;</span>
            <span style=color:#111>}</span>
            <span style=color:#111>res</span><span style=color:#f92672>+=</span><span style=color:#111>tree</span><span style=color:#111>.</span><span style=color:#111>order_of_key</span><span style=color:#111>(</span><span style=color:#111>it</span><span style=color:#111>.</span><span style=color:#111>F</span><span style=color:#f92672>+</span><span style=color:#111>it</span><span style=color:#111>.</span><span style=color:#111>S</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>)</span><span style=color:#f92672>-</span><span style=color:#111>tree</span><span style=color:#111>.</span><span style=color:#111>order_of_key</span><span style=color:#111>(</span><span style=color:#111>it</span><span style=color:#111>.</span><span style=color:#111>F</span><span style=color:#f92672>+</span><span style=color:#ae81ff>1</span><span style=color:#111>);</span>
        <span style=color:#111>}</span>
        <span style=color:#00a8c8>return</span> <span style=color:#111>res</span><span style=color:#111>;</span>
    <span style=color:#111>};</span>
    <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>i</span><span style=color:#f92672>=</span><span style=color:#ae81ff>1</span><span style=color:#111>;</span><span style=color:#111>i</span><span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>1e4</span><span style=color:#111>;</span><span style=color:#111>i</span><span style=color:#f92672>++</span><span style=color:#111>){</span>
        <span style=color:#00a8c8>if</span><span style=color:#111>(</span><span style=color:#111>fre</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>].</span><span style=color:#111>empty</span><span style=color:#111>())</span> <span style=color:#00a8c8>continue</span><span style=color:#111>;</span>
        <span style=color:#111>vector</span><span style=color:#f92672>&lt;</span><span style=color:#111>pii</span><span style=color:#f92672>&gt;</span> <span style=color:#111>left</span><span style=color:#111>(</span><span style=color:#111>all</span><span style=color:#111>(</span><span style=color:#111>fre</span><span style=color:#111>[</span><span style=color:#111>i</span><span style=color:#111>])),</span><span style=color:#111>right</span><span style=color:#111>;</span>
        <span style=color:#00a8c8>for</span><span style=color:#111>(</span><span style=color:#00a8c8>int</span> <span style=color:#111>j</span><span style=color:#f92672>=</span><span style=color:#111>max</span><span style=color:#111>(</span><span style=color:#ae81ff>1</span><span style=color:#111>,</span><span style=color:#111>i</span><span style=color:#f92672>-</span><span style=color:#111>k</span><span style=color:#111>);</span><span style=color:#111>j</span><span style=color:#f92672>&lt;=</span><span style=color:#111>i</span><span style=color:#f92672>+</span><span style=color:#111>k</span><span style=color:#f92672>&amp;&amp;</span><span style=color:#111>j</span><span style=color:#f92672>&lt;=</span><span style=color:#ae81ff>10000</span><span style=color:#111>;</span><span style=color:#111>j</span><span style=color:#f92672>++</span><span style=color:#111>){</span>
            <span style=color:#111>right</span><span style=color:#111>.</span><span style=color:#111>insert</span><span style=color:#111>(</span><span style=color:#111>right</span><span style=color:#111>.</span><span style=color:#111>end</span><span style=color:#111>(),</span><span style=color:#111>all</span><span style=color:#111>(</span><span style=color:#111>fre</span><span style=color:#111>[</span><span style=color:#111>j</span><span style=color:#111>]));</span>
        <span style=color:#111>}</span>
        <span style=color:#111>ans</span><span style=color:#f92672>+=</span><span style=color:#111>solve</span><span style=color:#111>(</span><span style=color:#111>left</span><span style=color:#111>,</span><span style=color:#111>right</span><span style=color:#111>);</span>
    <span style=color:#111>}</span>
    <span style=color:#111>cout</span><span style=color:#f92672>&lt;&lt;</span><span style=color:#111>ans</span><span style=color:#111>;</span>
    <span style=color:#00a8c8>return</span> <span style=color:#ae81ff>0</span><span style=color:#111>;</span>
<span style=color:#111>}</span>
</code></pre></div><div class=blog-tags><a href=https://blog.tgc-thallium.com/tags/data-structure/>Data Structure</a>&nbsp;</div></article></div><footer><div class=social-icons><a href=https://github.com/thallium name=GitHub><em class="fab fa-github"></em></a></div><div class=container><p class="credits copyright"><a href=https://blog.tgc-thallium.com/about>Gengchen</a>
&nbsp;&copy;
2021
&nbsp;/&nbsp;
<a href=https://blog.tgc-thallium.com/>Thallium's Blog</a>
&nbsp;&ndash;&nbsp;
<em class="fas fa-moon" id=dark-mode-toggle></em></p><p class="credits theme-by">Powered By <a href=https://gohugo.io>Hugo</a>&nbsp;
Theme
<a href=https://github.com/matsuyoshi30/harbor>Harbor</a></p></div></footer></body></html>